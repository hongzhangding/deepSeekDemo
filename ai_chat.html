<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI创业助手 - DeepSeek聊天</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        dark: '#1F2937',
                        light: '#F3F4F6',
                        deepseek: {
                            // 深色主题
                            dark: {
                                bg: '#0A0E17',
                                sidebar: '#151A27',
                                primary: '#507BF5',
                                secondary: '#2E3440',
                                text: '#E5E9F0',
                                textSecondary: '#81A1C1',
                                border: '#3B4252',
                                hover: '#2A2F3D'
                            },
                            // 浅色主题
                            light: {
                                bg: '#F7F9FC',
                                sidebar: '#FFFFFF',
                                primary: '#507BF5',
                                secondary: '#F0F2F5',
                                text: '#1A1A1A',
                                textSecondary: '#6B7280',
                                border: '#E5E7EB',
                                hover: '#E8EAED'
                            }
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.37)',
                    },
                    backdropBlur: {
                        'glass': '4px',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .glass-effect {
                @apply bg-white/10 backdrop-blur-glass shadow-glass border border-white/20;
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thin::-webkit-scrollbar {
                width: 6px;
            }
            .theme-dark .scrollbar-thin::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.1);
            }
            .theme-dark .scrollbar-thin::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.3);
                border-radius: 3px;
            }
            .theme-dark .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.5);
            }
            .theme-light .scrollbar-thin::-webkit-scrollbar-track {
                background: rgba(0, 0, 0, 0.05);
            }
            .theme-light .scrollbar-thin::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.2);
                border-radius: 3px;
            }
            .theme-light .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background: rgba(0, 0, 0, 0.4);
            }
            .typing-dot {
                @apply w-2 h-2 rounded-full animate-bounce;
            }
            .theme-dark .typing-dot {
                @apply bg-deepseek-dark-textSecondary;
            }
            .theme-light .typing-dot {
                @apply bg-deepseek-light-textSecondary;
            }
            .message-bubble-ai {
                @apply rounded-lg p-4 max-w-[85%] leading-relaxed;
            }
            .theme-dark .message-bubble-ai {
                @apply bg-deepseek-dark-secondary text-deepseek-dark-text;
            }
            .theme-light .message-bubble-ai {
                @apply bg-deepseek-light-secondary text-deepseek-light-text;
            }
            .message-bubble-user {
                @apply bg-deepseek-dark-primary text-white rounded-lg p-4 max-w-[85%] leading-relaxed;
            }
            .input-container {
                @apply rounded-lg flex items-center px-4 py-3 transition-colors;
            }
            .theme-dark .input-container {
                @apply bg-deepseek-dark-secondary border border-deepseek-dark-border focus-within:border-deepseek-dark-primary;
            }
            .theme-light .input-container {
                @apply bg-deepseek-light-secondary border border-deepseek-light-border focus-within:border-deepseek-light-primary;
            }
            .btn-hover:hover {
                @apply bg-opacity-80;
            }
            .theme-dark .btn-hover:hover {
                @apply bg-deepseek-dark-hover;
            }
            .theme-light .btn-hover:hover {
                @apply bg-deepseek-light-hover;
            }
        }
    </style>
</head>
<body class="theme-dark min-h-screen flex flex-col transition-colors duration-300">
    <!-- 顶部导航栏 -->
    <header class="theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border theme-dark:bg-deepseek-dark-bg/95 theme-light:bg-deepseek-light-bg/95 backdrop-blur-sm sticky top-0 z-10 transition-colors duration-300">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <a href="index.html" class="theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text hover:text-white transition-colors">
                    <i class="fa fa-arrow-left text-xl"></i>
                </a>
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-r from-deepseek-dark-primary to-purple-500 rounded-full flex items-center justify-center">
                        <i class="fa fa-robot text-white"></i>
                    </div>
                    <h1 class="text-lg font-bold theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text">AI创业助手</h1>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button id="toggle-fullscreen" class="theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary hover:text-white transition-colors p-2 rounded-full btn-hover">
                    <i class="fa fa-expand text-xl"></i>
                </button>
                <button id="theme-toggle" class="theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary hover:text-white transition-colors p-2 rounded-full btn-hover">
                    <i class="fa fa-moon-o text-xl"></i>
                </button>
                <button id="configure-api-key" class="theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary hover:text-white transition-colors p-2 rounded-full btn-hover">
                    <i class="fa fa-cog text-xl"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <main class="flex-1 flex flex-col">
        <!-- 聊天消息区域 -->
        <div id="chat-container" class="flex-1 overflow-y-auto scrollbar-thin p-6 space-y-6 theme-dark:bg-deepseek-dark-bg theme-light:bg-deepseek-light-bg transition-colors duration-300">
            <!-- 欢迎消息 -->
            <div class="flex items-start space-x-3">
                <div class="w-8 h-8 bg-gradient-to-r from-deepseek-dark-primary to-purple-500 rounded-full flex items-center justify-center shrink-0">
                    <i class="fa fa-robot text-white text-sm"></i>
                </div>
                <div class="message-bubble-ai">
                    <p>您好！我是您的AI创业助手。</p>
                    <p class="mt-2">我可以为您提供关于AI创业的专业建议，包括：</p>
                    <ul class="mt-2 list-disc list-inside space-y-1 theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary">
                        <li>市场趋势分析</li>
                        <li>创业方向选择</li>
                        <li>技术选型建议</li>
                        <li>团队建设指导</li>
                        <li>融资策略规划</li>
                    </ul>
                    <p class="mt-2">请问您有什么问题需要咨询？</p>
                </div>
            </div>

            <!-- 示例问题提示 -->
            <div class="flex flex-wrap gap-2 ml-11">
                <button class="example-question theme-dark:bg-deepseek-dark-secondary theme-light:bg-deepseek-light-secondary hover:opacity-80 theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary px-4 py-2 rounded-lg text-sm transition-colors theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border">
                    2026年AI创业的热门方向有哪些？
                </button>
                <button class="example-question theme-dark:bg-deepseek-dark-secondary theme-light:bg-deepseek-light-secondary hover:opacity-80 theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary px-4 py-2 rounded-lg text-sm transition-colors theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border">
                    如何评估一个AI创业想法的可行性？
                </button>
                <button class="example-question theme-dark:bg-deepseek-dark-secondary theme-light:bg-deepseek-light-secondary hover:opacity-80 theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary px-4 py-2 rounded-lg text-sm transition-colors theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border">
                    AI创业团队应该具备哪些核心能力？
                </button>
            </div>
        </div>

        <!-- 输入区域 -->
        <div class="theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border-t p-4 theme-dark:bg-deepseek-dark-bg/95 theme-light:bg-deepseek-light-bg/95 backdrop-blur-sm transition-colors duration-300">
            <div class="container mx-auto max-w-4xl">
                <div class="input-container">
                    <input 
                        type="text" 
                        id="user-input" 
                        placeholder="输入您的问题..." 
                        class="flex-1 bg-transparent border-none outline-none theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text theme-dark:placeholder-deepseek-dark-textSecondary theme-light:placeholder-deepseek-light-textSecondary"
                    >
                    <button id="send-message" class="ml-2 text-deepseek-dark-primary hover:text-white transition-colors p-2">
                        <i class="fa fa-paper-plane text-xl"></i>
                    </button>
                </div>
                <div class="flex justify-between items-center mt-3 text-xs theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary">
                    <div id="api-key-status" class="flex items-center">
                        <i class="fa fa-key mr-1"></i> 
                        <span>API密钥已配置</span>
                    </div>
                    <div>
                        <span>按 Enter 发送，Shift + Enter 换行</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- API密钥配置模态框 -->
    <div id="api-key-modal" class="fixed inset-0 bg-black/50 theme-dark:bg-black/50 theme-light:bg-black/30 z-50 flex items-center justify-center hidden backdrop-blur-sm transition-colors duration-300">
        <div class="theme-dark:bg-deepseek-dark-sidebar theme-light:bg-deepseek-light-sidebar theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border rounded-xl max-w-md w-full mx-4 shadow-xl">
            <div class="flex items-center justify-between p-5 theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border-b">
                <h3 class="text-lg font-bold theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text">配置API密钥</h3>
                <button id="close-api-key-modal" class="theme-dark:text-deepseek-dark-textSecondary theme-light:text-deepseek-light-textSecondary hover:text-white">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-5">
                <div class="mb-4">
                    <label for="api-key-input" class="block text-sm font-medium mb-2 theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text">DeepSeek API密钥</label>
                    <input 
                        type="text" 
                        id="api-key-input" 
                        class="w-full theme-dark:bg-deepseek-dark-bg theme-light:bg-deepseek-light-bg theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border rounded-lg px-4 py-2 theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text theme-dark:placeholder-deepseek-dark-textSecondary theme-light:placeholder-deepseek-light-textSecondary focus:outline-none focus:border-deepseek-dark-primary"
                        placeholder="sk-..."
                    >
                </div>
                <div class="theme-dark:bg-deepseek-dark-bg theme-light:bg-deepseek-light-bg theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border rounded-lg p-4 mb-4 text-sm">
                    <div class="flex items-start">
                        <i class="fa fa-info-circle text-deepseek-dark-primary mt-1 mr-2"></i>
                        <p class="theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text">API密钥将安全地存储在您的浏览器本地，不会被上传到任何服务器。</p>
                    </div>
                </div>
                <div class="flex space-x-3">
                    <button id="save-api-key" class="flex-1 bg-deepseek-dark-primary hover:bg-opacity-80 text-white py-2 rounded-lg transition-colors">
                        保存
                    </button>
                    <button id="reset-api-key" class="flex-1 theme-dark:bg-deepseek-dark-bg theme-light:bg-deepseek-light-bg hover:opacity-80 theme-dark:text-deepseek-dark-text theme-light:text-deepseek-light-text theme-dark:border-deepseek-dark-border theme-light:border-deepseek-light-border border py-2 rounded-lg transition-colors">
                        重置
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <a href="https://platform.deepseek.com/apikeys" target="_blank" class="text-deepseek-dark-primary hover:underline text-sm">
                        <i class="fa fa-external-link mr-1"></i> 前往DeepSeek平台获取API密钥
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM元素
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendMessageBtn = document.getElementById('send-message');
        const exampleQuestions = document.querySelectorAll('.example-question');
        const configureApiKeyBtn = document.getElementById('configure-api-key');
        const apiKeyModal = document.getElementById('api-key-modal');
        const closeApiKeyModal = document.getElementById('close-api-key-modal');
        const apiKeyInput = document.getElementById('api-key-input');
        const saveApiKeyBtn = document.getElementById('save-api-key');
        const resetApiKeyBtn = document.getElementById('reset-api-key');
        const apiKeyStatus = document.getElementById('api-key-status');
        const toggleFullscreenBtn = document.getElementById('toggle-fullscreen');
        const themeToggleBtn = document.getElementById('theme-toggle');

        // 设置默认API密钥
		let DEFAULT_API_KEY = ''
        let DEEPSEEK_API_KEY = localStorage.getItem('deepseek_api_key') || DEFAULT_API_KEY;
        
        // 初始化时检查并设置默认API密钥
        if (!localStorage.getItem('deepseek_api_key')) {
            localStorage.setItem('deepseek_api_key', DEFAULT_API_KEY);
        }

        // 主题切换功能
        function initTheme() {
            const savedTheme = localStorage.getItem('chatTheme') || 'dark';
            setTheme(savedTheme);
        }

        function setTheme(theme) {
            const body = document.body;
            body.className = body.className.replace(/theme-\w+/g, '');
            body.classList.add(`theme-${theme}`);
            
            // 更新主题切换按钮图标
            const icon = themeToggleBtn.querySelector('i');
            if (theme === 'dark') {
                icon.className = 'fa fa-sun-o text-xl';
            } else {
                icon.className = 'fa fa-moon-o text-xl';
            }
            
            localStorage.setItem('chatTheme', theme);
        }

        // 主题切换按钮事件
        themeToggleBtn.addEventListener('click', () => {
            const currentTheme = localStorage.getItem('chatTheme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
        });

        // 预设问答数据（作为API调用失败的回退方案）
        const qaDatabase = {
            '2026年AI创业的热门方向有哪些？': `
                根据最新市场趋势，2026年AI创业的热门方向包括：

                1. **垂直领域AI应用**：针对特定行业（如医疗、金融、教育）的深度AI解决方案
                2. **AI+物联网**：智能设备和物联网系统的AI驱动管理平台
                3. **生成式AI应用**：超越文本和图像，扩展到视频、3D模型等多模态内容生成
                4. **AI安全与隐私**：AI系统的安全防护和隐私保护解决方案
                5. **AI辅助开发工具**：提升开发者效率的智能编程助手和自动化工具

                这些方向既有技术创新空间，也有明确的市场需求，适合不同规模的创业团队。
            `,
            '如何评估一个AI创业想法的可行性？': `
                评估AI创业想法可行性可从以下几个维度考虑：

                1. **问题清晰度**：您的AI解决方案是否针对明确的痛点？目标用户是否清晰？
                2. **技术可行性**：以当前AI技术，您的想法是否可以实现？是否有技术壁垒？
                3. **数据获取**：您是否能够获取足够的高质量数据来训练和改进模型？
                4. **市场需求**：目标市场规模如何？用户是否愿意为解决方案付费？
                5. **竞争分析**：现有解决方案如何？您的差异化优势是什么？
                6. **商业模式**：如何变现？盈利周期预计多长？
                7. **团队能力**：团队是否具备AI技术和行业领域的复合能力？

                建议先开发MVP（最小可行产品）进行市场验证，根据反馈快速迭代。
            `,
            'AI创业团队应该具备哪些核心能力？': `
                一个成功的AI创业团队应具备以下核心能力：

                1. **技术能力**：
                   - 深度学习和机器学习算法 expertise
                   - 大数据处理和分析能力
                   - 云计算和分布式系统经验
                   - 软件工程和产品开发能力

                2. **行业洞察力**：
                   - 对目标行业的深度理解
                   - 识别真实痛点和需求的能力
                   - 预见行业发展趋势的眼光

                3. **商业能力**：
                   - 商业模式设计和验证
                   - 市场定位和用户获取策略
                   - 销售和商务拓展能力
                   - 融资和财务管理

                4. **团队协作**：
                   - 跨学科沟通和协作能力
                   - 敏捷开发和快速迭代能力
                   - 面对挫折和调整方向的韧性

                理想的团队结构应包括技术专家、行业专家和商业人才的合理搭配。
            `
        };

        // 更新API密钥状态显示
        function updateApiKeyStatus() {
            const hasApiKey = !!localStorage.getItem('deepseek_api_key');
            apiKeyStatus.innerHTML = hasApiKey 
                ? '<i class="fa fa-key mr-1"></i> <span>API密钥已配置</span>'
                : '<i class="fa fa-exclamation-triangle mr-1 text-yellow-500"></i> <span>未配置API密钥</span>';
        }

        // 显示API密钥配置模态框
        configureApiKeyBtn.addEventListener('click', () => {
            apiKeyInput.value = localStorage.getItem('deepseek_api_key') || '';
            apiKeyModal.classList.remove('hidden');
        });

        // 关闭API密钥配置模态框
        closeApiKeyModal.addEventListener('click', () => {
            apiKeyModal.classList.add('hidden');
        });

        // 点击模态框外部关闭
        apiKeyModal.addEventListener('click', (e) => {
            if (e.target === apiKeyModal) {
                apiKeyModal.classList.add('hidden');
            }
        });

        // 保存API密钥
        saveApiKeyBtn.addEventListener('click', () => {
            const key = apiKeyInput.value.trim();
            if (key) {
                localStorage.setItem('deepseek_api_key', key);
                DEEPSEEK_API_KEY = key;
                updateApiKeyStatus();
                apiKeyModal.classList.add('hidden');
                
                // 显示成功提示
                showToast('API密钥保存成功！');
            }
        });

        // 重置API密钥
        resetApiKeyBtn.addEventListener('click', () => {
            localStorage.removeItem('deepseek_api_key');
            DEEPSEEK_API_KEY = DEFAULT_API_KEY;
            apiKeyInput.value = '';
            updateApiKeyStatus();
            
            // 显示提示
            showToast('API密钥已重置为默认值');
        });

        // 全屏切换
        toggleFullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error(`全屏请求失败: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        });

        // 发送消息
        function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // 添加用户消息到聊天界面
            addUserMessage(message);
            
            // 清空输入框
            userInput.value = '';
            
            // 显示AI正在输入状态
            showTypingIndicator();
            
            // 处理消息（调用API或使用预设回答）
            processMessage(message);
        }

        // 添加用户消息
        function addUserMessage(message) {
            const messageElement = document.createElement('div');
            messageElement.className = 'flex items-start justify-end space-x-3';
            messageElement.innerHTML = `
                <div class="message-bubble-user">
                    <p>${escapeHtml(message)}</p>
                </div>
                <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center shrink-0">
                    <i class="fa fa-user text-white text-sm"></i>
                </div>
            `;
            chatContainer.appendChild(messageElement);
            scrollToBottom();
        }

        // 添加AI消息
        function addAIMessage(message) {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }

            const messageElement = document.createElement('div');
            messageElement.className = 'flex items-start space-x-3';
            messageElement.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-deepseek-primary to-purple-500 rounded-full flex items-center justify-center shrink-0">
                    <i class="fa fa-robot text-white text-sm"></i>
                </div>
                <div class="message-bubble-ai">
                    <div class="markdown-body">${parseMarkdown(message)}</div>
                </div>
            `;
            chatContainer.appendChild(messageElement);
            scrollToBottom();
        }

        // 显示AI正在输入状态
        function showTypingIndicator() {
            const typingElement = document.createElement('div');
            typingElement.id = 'typing-indicator';
            typingElement.className = 'flex items-start space-x-3';
            typingElement.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-deepseek-primary to-purple-500 rounded-full flex items-center justify-center shrink-0">
                    <i class="fa fa-robot text-white text-sm"></i>
                </div>
                <div class="message-bubble-ai flex items-center space-x-2 py-2">
                    <span class="typing-dot" style="animation-delay: 0s"></span>
                    <span class="typing-dot" style="animation-delay: 0.2s"></span>
                    <span class="typing-dot" style="animation-delay: 0.4s"></span>
                </div>
            `;
            chatContainer.appendChild(typingElement);
            scrollToBottom();
        }

        // 处理消息（调用API或使用预设回答）
        function processMessage(message) {
            // 检查是否有预设回答
            if (qaDatabase[message]) {
                setTimeout(() => {
                    addAIMessage(qaDatabase[message]);
                }, 1000);
                return;
            }

            // 调用DeepSeek API
            callDeepSeekAPI(message);
        }

        // 调用DeepSeek API
        async function callDeepSeekAPI(message) {
            try {
                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: '你是一个专业的AI创业顾问，精通人工智能技术趋势、创业策略和商业模式设计。请提供专业、实用且有深度的建议。'
                            },
                            {
                                role: 'user',
                                content: message
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 2000
                    })
                });

                if (!response.ok) {
                    throw new Error(`API请求失败: ${response.statusText}`);
                }

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;
                
                addAIMessage(aiResponse);
            } catch (error) {
                console.error('API调用失败:', error);
                
                // 使用备用回答
                const fallbackResponse = `
                    很抱歉，我暂时无法连接到DeepSeek API。这可能是由于以下原因：

                    1. API密钥无效或已过期
                    2. 网络连接问题
                    3. DeepSeek服务暂时不可用

                    请检查您的API密钥配置，或稍后再试。您也可以尝试点击上方的示例问题，我可以提供一些预设的回答。
                `;
                addAIMessage(fallbackResponse);
            }
        }

        // 滚动到底部
        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // 转义HTML字符
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // 简单的Markdown解析
        function parseMarkdown(text) {
            // 替换标题
            text = text.replace(/^### (.*$)/gm, '<h3 class="text-lg font-bold mt-4 mb-2">$1</h3>');
            text = text.replace(/^## (.*$)/gm, '<h2 class="text-xl font-bold mt-5 mb-3">$1</h2>');
            text = text.replace(/^# (.*$)/gm, '<h1 class="text-2xl font-bold mt-6 mb-4">$1</h1>');
            
            // 替换加粗
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // 替换斜体
            text = text.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // 替换代码块
            text = text.replace(/```([\s\S]*?)```/g, '<pre class="bg-deepseek-bg p-3 rounded-lg overflow-x-auto my-2"><code>$1</code></pre>');
            
            // 替换行内代码
            text = text.replace(/`(.*?)`/g, '<code class="bg-deepseek-bg px-1 py-0.5 rounded">$1</code>');
            
            // 替换无序列表
            text = text.replace(/^\s*\*\s(.*$)/gm, '<li class="ml-6 list-disc">$1</li>');
            
            // 替换有序列表
            text = text.replace(/^\s*\d+\.\s(.*$)/gm, '<li class="ml-6 list-decimal">$1</li>');
            
            // 将连续的<li>包装在<ul>中
            text = text.replace(/(<li class="ml-6 list-disc">.*?<\/li>)+/gs, '<ul class="my-2">$&</ul>');
            text = text.replace(/(<li class="ml-6 list-decimal">.*?<\/li>)+/gs, '<ol class="my-2">$&</ol>');
            
            // 替换段落
            text = text.replace(/^(?!<[a-z])/gm, '<p>$&</p>');
            
            return text;
        }

        // 显示提示消息
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-deepseek-secondary text-deepseek-text px-4 py-2 rounded-lg shadow-lg z-50 transition-opacity duration-300';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('opacity-0');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        // 事件监听
        sendMessageBtn.addEventListener('click', sendMessage);
        
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // 示例问题点击事件
        exampleQuestions.forEach(question => {
            question.addEventListener('click', () => {
                userInput.value = question.textContent.trim();
                sendMessage();
            });
        });

        // 初始化
        updateApiKeyStatus();
        initTheme();
        scrollToBottom();
    </script>
</body>
</html>